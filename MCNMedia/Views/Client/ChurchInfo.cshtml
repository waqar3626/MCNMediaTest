@using Microsoft.AspNetCore.Http;
@model MCNMedia_Dev.Models.Church
@{
    ViewData["Title"] = "ChurchInfo";
    Layout = "~/Views/Shared/_LayoutClient.cshtml";

}
@{
    int usrId = (int)Context.Session.GetInt32("UserId");
    List<SelectListItem> SelectList = Lists.GetUserAssignChurchListForDDL(usrId);


    //string name ="";
    //string address = "";
    //name = Model.ChurchName;
    //address = Model.Address;
    //string abc = "12345";



}

<h1>Client</h1>
<form method="get">
    <div class="card ">
        <div class="card-body">
            <div class="form-group row">

                @Html.DropDownList("ChurchId", SelectList, new { @class = "form-control", @onchange = "javascript:onChangeFunction()", @id = "ddlid" })
                @*@Html.DropDownList("Churches.ClientTypeId", ClientTypes, new { @class = "form-control" })*@
                <span class="text-danger"></span>
            </div>
            

        </div>
    </div>
</form>
<form asp-action="UpdateChurchInfo" method="post">
    <div class="card">
        <div class="card-body">
            <input type="hidden" />
            <div class=".display2 mdi mdi-information-variant"> General Info</div>
            <div class="form-group row ">
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body text-center">
                            <div>
                                <img id="ImageUrl12" class="auth-img-bg rounded-circle mb-2" style="width:250px; height:200px;" alt="profile image" />

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class=" form-group row">
                        <div class="col-sm-12">

                            <input type="hidden" asp-for="CountyId" value="@Model.CountyId" id="CountyId123" />
                            <input type="hidden" asp-for="ClientTypeId" value="@Model.ClientTypeId" id="ClientTypeId123" />
                            <input type="hidden" asp-for="ImageURl" value="@Model.ImageURl" id="ImageURl123" />
                            <label class="form-label">Name</label>

                            @Html.TextBoxFor(Model => Model.ChurchName, new { @class = "form-control" })
                            <input type="hidden" asp-for="ChurchId" value="@Model.ChurchId" id="ChurchId123" />
                            @*<input type="text" class="form-control" asp-for="ChurchName"  />*@
                        </div>
                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">Email</label>
                            <input type="text" class="form-control" value="@Model.EmailAddress" placeholder="Email" asp-for="EmailAddress" />


                        </div>
                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">Phone</label>
                            <input type="text" class="form-control" placeholder="Phone" asp-for="Phone" />
                        </div>
                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">Address</label>
                            <input type="text" class="form-control" placeholder="Address" asp-for="Address" />
                        </div>
                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">Town</label>
                            <input type="text" class="form-control" placeholder="Town" asp-for="Town" />
                        </div>
                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">WebSite</label>
                            <input type="text" class="form-control" placeholder="Address" asp-for="Website" />
                        </div>

                    </div>
                    <div class=" form-group row">
                        <div class="col-sm-12">
                            <label class="form-label">Password</label>
                            <input type="text" id="Password" class="form-control" placeholder="Password" asp-for="Password" />
                        </div>
                    </div>
                    <div class="form-group float-right">

                        <button type="submit" value="Update" class="btn btn-primary btn-sm "><i class="fa fa-plus"></i> Update</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</form>

<script type="text/javascript">
    $(document).ready(function () {

        $("#ddlid").prop("selectedIndex", 0); // here 0 means select first option
        onChangeFunction();
    });
      function onChangeFunction() {


        var churchId = document.getElementById('ddlid').value;
        //var formData = new FormData();
        //formData.append("ddlValue", ddlValue);

        $.ajax({
            type: "GET",
            //url: "/Client/Client/",
            url: '@Url.Action("GetChurchInfoById", "Client")',
            data: { churchId: churchId },
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result) {
                var html = '';

                $.each(result, function (key, item) {

                    $("#ChurchName").val(item.churchName) ;
                    $("#EmailAddress").val(item.emailAddress);
                    $("#Phone").val(item.phone);
                    $("#Address").val(item.address);
                    $("#Town").val(item.town);
                    $("#Website").val(item.website);
                    $("#ChurchId123").val(item.churchId);
                    $("#Password").val(item.password);
                    $("#ImageUrl12").attr("src", item.imageURl);
                    $("#CountyId123").val(item.countyId);
                    $("#ClientTypeId123").val(item.clientTypeId);
                    $("#ImageURl123").val( item.imageURl);



                });
            },
            error: function (errormessage) {
                alert(errormessage.responseText);
            }


            //data: formData,
            //data: { AddVidTabName: AddvidTabName, VidFile11: VidFile1 },
        });

    }


</script>